<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Kaggle Titanic Dataset Top 1% Solution | Hedwig Explains</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Kaggle Titanic Dataset Top 1% Solution" />
<meta name="author" content="Hitesh Kumar" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Top1%: FastAI Beginner Tutorial" />
<meta property="og:description" content="Top1%: FastAI Beginner Tutorial" />
<link rel="canonical" href="https://hiteshhedwig.github.io/hedwig-explains/fastai/kaggle/datascience/2020/10/13/titanic-fastai.html" />
<meta property="og:url" content="https://hiteshhedwig.github.io/hedwig-explains/fastai/kaggle/datascience/2020/10/13/titanic-fastai.html" />
<meta property="og:site_name" content="Hedwig Explains" />
<meta property="og:image" content="https://hiteshhedwig.github.io/hedwig-explains/images/copied_from_nb/img/ship.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-10-13T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"Top1%: FastAI Beginner Tutorial","url":"https://hiteshhedwig.github.io/hedwig-explains/fastai/kaggle/datascience/2020/10/13/titanic-fastai.html","@type":"BlogPosting","headline":"Kaggle Titanic Dataset Top 1% Solution","dateModified":"2020-10-13T00:00:00-05:00","datePublished":"2020-10-13T00:00:00-05:00","author":{"@type":"Person","name":"Hitesh Kumar"},"image":"https://hiteshhedwig.github.io/hedwig-explains/images/copied_from_nb/img/ship.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://hiteshhedwig.github.io/hedwig-explains/fastai/kaggle/datascience/2020/10/13/titanic-fastai.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/hedwig-explains/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://hiteshhedwig.github.io/hedwig-explains/feed.xml" title="Hedwig Explains" /><link rel="shortcut icon" type="image/x-icon" href="/hedwig-explains/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/hedwig-explains/">Hedwig Explains</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/hedwig-explains/about/">About Me</a><a class="page-link" href="/hedwig-explains/search/">Search</a><a class="page-link" href="/hedwig-explains/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Kaggle Titanic Dataset Top 1% Solution</h1><p class="page-description">Top1%: FastAI Beginner Tutorial</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-10-13T00:00:00-05:00" itemprop="datePublished">
        Oct 13, 2020
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Hitesh Kumar</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      18 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/hedwig-explains/categories/#fastai">fastai</a>
        &nbsp;
      
        <a class="category-tags-link" href="/hedwig-explains/categories/#kaggle">kaggle</a>
        &nbsp;
      
        <a class="category-tags-link" href="/hedwig-explains/categories/#datascience">datascience</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/hiteshhedwig/hedwig-explains/tree/master/_notebooks/2020-10-13-titanic-fastai.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/hedwig-explains/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/hiteshhedwig/hedwig-explains/master?filepath=_notebooks%2F2020-10-13-titanic-fastai.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/hedwig-explains/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/hiteshhedwig/hedwig-explains/blob/master/_notebooks/2020-10-13-titanic-fastai.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/hedwig-explains/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#What-are-we-doing?">What are we doing? </a></li>
<li class="toc-entry toc-h1"><a href="#Intro:">Intro: </a></li>
<li class="toc-entry toc-h1"><a href="#Importing-and-Loading-files">Importing and Loading files </a></li>
<li class="toc-entry toc-h1"><a href="#FastAI2">FastAI2 </a></li>
<li class="toc-entry toc-h1"><a href="#Model:">Model: </a>
<ul>
<li class="toc-entry toc-h2"><a href="#Accuracy-on-validation-dataset">Accuracy on validation dataset </a></li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#TEST-dataset">TEST dataset </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-10-13-titanic-fastai.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/hedwig-explains/images/copied_from_nb/img/ship.png" alt="Cover Image"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="What-are-we-doing?">
<a class="anchor" href="#What-are-we-doing?" aria-hidden="true"><span class="octicon octicon-link"></span></a>What are we doing?<a class="anchor-link" href="#What-are-we-doing?"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this blog, we use kaggle titanic dataset. Which got data of all the people who were in titanic fiasco accident. Sp, we are using some part of data to train model so that it can predict if someone survived in titanic fiasco.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Intro:">
<a class="anchor" href="#Intro:" aria-hidden="true"><span class="octicon octicon-link"></span></a>Intro:<a class="anchor-link" href="#Intro:"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this blog, i am explaining about how you can get kaggle top 1% score at beginner <a href="https://www.kaggle.com/c/titanic">dataset</a>. But for the better result. I am using <a href="https://www.kaggle.com/pavlofesenko/titanic-extended">this data</a>. Which is a bit extension of kaggle original one.</p>
<p>We are not USING EDA here. This post is to show you how can a powerful tool like fastai can make life so simple. Only automatic preprocessing data in fastai and training model and getting score of top1%.</p>
<p>Here, we are using dataset which is a bit extension of classic titanic dataset. you can check out this: <a href="https://www.kaggle.com/pavlofesenko/titanic-extended">https://www.kaggle.com/pavlofesenko/titanic-extended</a></p>
<p>And It is fair to use this, i reckon. We are not altering test data at all. Only using new features(Like how we generate new features). Number of rows remains same in both test and training data.</p>
<p>We will be using newly released fastai2.0 library and standard sklearn. fastai2.0 is worth checking out <a href="https://docs.fast.ai/">https://docs.fast.ai/</a> It is more fast and efficient. With this, we can minimize our effort for preprocessing and gain better results.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Installing fastai2, yes its not preinstalled. We would need to install on our own. Incase you are running this notebook on kaggle workspace.
</p>
<div class="flash flash-error">
    <svg class="octicon octicon-alert octicon octicon-alert" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path></svg>
    <strong>Warning: </strong>If you get some sort of error in importing fastai modules. I would recommend changing notebook environment to <code>Always use latest environment Always get the latest package versions, but you may have to modify your code</code>
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install fastai2
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install <span class="nv">fastcore</span><span class="o">==</span><span class="m">0</span>.1.35 ##Currently supported with fastai2
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">fastcore</span>
<span class="n">fastcore</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>'0.1.35'</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">fastai2</span>
<span class="n">fastai2</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>'0.0.30'</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Importing-and-Loading-files">
<a class="anchor" href="#Importing-and-Loading-files" aria-hidden="true"><span class="octicon octicon-link"></span></a>Importing and Loading files<a class="anchor-link" href="#Importing-and-Loading-files"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, starting with importing the intended modules.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai2.tabular.all</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_test</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'/kaggle/input/titanic-extended/test.csv'</span><span class="p">)</span>
<span class="n">df_train</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'../input/titanic-extended/train.csv'</span><span class="p">)</span>
<span class="n">df_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>...</th>
      <th>Embarked</th>
      <th>WikiId</th>
      <th>Name_wiki</th>
      <th>Age_wiki</th>
      <th>Hometown</th>
      <th>Boarded</th>
      <th>Destination</th>
      <th>Lifeboat</th>
      <th>Body</th>
      <th>Class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>...</td>
      <td>S</td>
      <td>691.0</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>22.0</td>
      <td>Bridgerule, Devon, England</td>
      <td>Southampton</td>
      <td>Qu'Appelle Valley, Saskatchewan, Canada</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1.0</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Thayer)</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>...</td>
      <td>C</td>
      <td>90.0</td>
      <td>Cumings, Mrs. Florence Briggs (née Thayer)</td>
      <td>35.0</td>
      <td>New York, New York, US</td>
      <td>Cherbourg</td>
      <td>New York, New York, US</td>
      <td>4</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1.0</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>...</td>
      <td>S</td>
      <td>865.0</td>
      <td>Heikkinen, Miss Laina</td>
      <td>26.0</td>
      <td>Jyväskylä, Finland</td>
      <td>Southampton</td>
      <td>New York City</td>
      <td>14?</td>
      <td>NaN</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1.0</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>...</td>
      <td>S</td>
      <td>127.0</td>
      <td>Futrelle, Mrs. Lily May (née Peel)</td>
      <td>35.0</td>
      <td>Scituate, Massachusetts, US</td>
      <td>Southampton</td>
      <td>Scituate, Massachusetts, US</td>
      <td>D</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>...</td>
      <td>S</td>
      <td>627.0</td>
      <td>Allen, Mr. William Henry</td>
      <td>35.0</td>
      <td>Birmingham, West Midlands, England</td>
      <td>Southampton</td>
      <td>New York City</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Just taking abit statistical look into data.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
      <th>WikiId</th>
      <th>Age_wiki</th>
      <th>Class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>714.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>889.000000</td>
      <td>887.000000</td>
      <td>889.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>446.000000</td>
      <td>0.383838</td>
      <td>2.308642</td>
      <td>29.699118</td>
      <td>0.523008</td>
      <td>0.381594</td>
      <td>32.204208</td>
      <td>665.466817</td>
      <td>29.322063</td>
      <td>2.307087</td>
    </tr>
    <tr>
      <th>std</th>
      <td>257.353842</td>
      <td>0.486592</td>
      <td>0.836071</td>
      <td>14.526497</td>
      <td>1.102743</td>
      <td>0.806057</td>
      <td>49.693429</td>
      <td>380.796997</td>
      <td>13.930089</td>
      <td>0.837713</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.420000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.420000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>223.500000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>20.125000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.910400</td>
      <td>336.000000</td>
      <td>20.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>446.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>28.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.454200</td>
      <td>672.000000</td>
      <td>28.000000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>668.500000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>38.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>31.000000</td>
      <td>996.000000</td>
      <td>38.000000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>891.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>80.000000</td>
      <td>8.000000</td>
      <td>6.000000</td>
      <td>512.329200</td>
      <td>1314.000000</td>
      <td>74.000000</td>
      <td>3.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before proceeding with anything else. It's important to check, if our data contains any missing values or not. For Calculating the average null values we have in our data. It is important to know. Just to get intuition about data</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Age            0.198653
Age_wiki       0.004489
Boarded        0.002245
Body           0.902357
Cabin          0.771044
Class          0.002245
Destination    0.002245
Embarked       0.002245
Fare           0.000000
Hometown       0.002245
Lifeboat       0.612795
Name           0.000000
Name_wiki      0.002245
Parch          0.000000
PassengerId    0.000000
Pclass         0.000000
Sex            0.000000
SibSp          0.000000
Survived       0.000000
Ticket         0.000000
WikiId         0.002245
dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Getting names of columns according to its datatype.</p>
<p>This will allow us to understand which feature is int, float, and object(categorical)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">dtypes</span>
<span class="n">g_train</span> <span class="o">=</span><span class="n">df_train</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df_train</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span>
<span class="n">g_train</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{int64: ['PassengerId', 'Pclass', 'SibSp', 'Parch'], float64: ['Survived', 'Age', 'Fare', 'WikiId', 'Age_wiki', 'Class'], object: ['Name', 'Sex', 'Ticket', 'Cabin', 'Embarked', 'Name_wiki', 'Hometown', 'Boarded', 'Destination', 'Lifeboat', 'Body']}</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now this might be a bit puzzling if you are new to fastai. And its completely alright.</p>
<p>cat_names refers to the features which are categorical.</p>
<p>cont_names refers to the features which are continuous. For example : int and float</p>
<p>fastai needs them in order to do preprocessing for you properly</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat_names</span><span class="o">=</span> <span class="p">[</span>
        <span class="s1">'Name'</span><span class="p">,</span> <span class="s1">'Sex'</span><span class="p">,</span> <span class="s1">'Ticket'</span><span class="p">,</span> <span class="s1">'Cabin'</span><span class="p">,</span> 
        <span class="s1">'Embarked'</span><span class="p">,</span> <span class="s1">'Name_wiki'</span><span class="p">,</span> <span class="s1">'Hometown'</span><span class="p">,</span> 
        <span class="s1">'Boarded'</span><span class="p">,</span> <span class="s1">'Destination'</span><span class="p">,</span> <span class="s1">'Lifeboat'</span><span class="p">,</span> 
        <span class="s1">'Body'</span>
<span class="p">]</span>

<span class="n">cont_names</span> <span class="o">=</span> <span class="p">[</span> 
    <span class="s1">'PassengerId'</span><span class="p">,</span> <span class="s1">'Pclass'</span><span class="p">,</span> <span class="s1">'SibSp'</span><span class="p">,</span> <span class="s1">'Parch'</span><span class="p">,</span> 
    <span class="s1">'Age'</span><span class="p">,</span> <span class="s1">'Fare'</span><span class="p">,</span> <span class="s1">'WikiId'</span><span class="p">,</span> <span class="s1">'Age_wiki'</span><span class="p">,</span><span class="s1">'Class'</span>
 <span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="FastAI2">
<a class="anchor" href="#FastAI2" aria-hidden="true"><span class="octicon octicon-link"></span></a>FastAI2<a class="anchor-link" href="#FastAI2"> </a>
</h1>
<p>now we are diving into fastai2. looking down at code. Might be new and intimidating. But no worries,
following the documentation helped me. <a href="https://docs.fast.ai/tutorial.tabular">https://docs.fast.ai/tutorial.tabular</a></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits</span> <span class="o">=</span> <span class="n">RandomSplitter</span><span class="p">(</span><span class="n">valid_pct</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)(</span><span class="n">range_of</span><span class="p">(</span><span class="n">df_train</span><span class="p">))</span>

<span class="n">to</span> <span class="o">=</span> <span class="n">TabularPandas</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">procs</span><span class="o">=</span><span class="p">[</span><span class="n">Categorify</span><span class="p">,</span> <span class="n">FillMissing</span><span class="p">,</span><span class="n">Normalize</span><span class="p">],</span>
                   <span class="n">cat_names</span> <span class="o">=</span> <span class="n">cat_names</span><span class="p">,</span>
                   <span class="n">cont_names</span> <span class="o">=</span> <span class="n">cont_names</span><span class="p">,</span>
                   <span class="n">y_names</span><span class="o">=</span><span class="s1">'Survived'</span><span class="p">,</span>
                   <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we are using fastai TabularPandas library. Which will do all the preprocessing for us.
before that splitting our data into validation set to have a fair amount of idea that we are not overfitting the data. valid_pct= 0.2 means (as you may have guessed by now) it means 20% validation data.</p>
<p>y_names, using column we are <code>target to be predicted</code>.
procs are [Categorify, FillMissing,Normalize], Convering objects into category, filling the missing value and normalizing the content for quick processing.
</p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM0 8a8 8 0 1116 0A8 8 0 010 8zm6.5-.25A.75.75 0 017.25 7h1a.75.75 0 01.75.75v2.75h.25a.75.75 0 010 1.5h-2a.75.75 0 010-1.5h.25v-2h-.25a.75.75 0 01-.75-.75zM8 6a1 1 0 100-2 1 1 0 000 2z"></path></svg>
    <strong>Note: </strong>Tabularpandas function creates a new column if there is any missing value spotted in any particular feature(only float or int column). for example: lets say Fare has a missing value somewhere. It will create a new column named ’Fare_na’ where it will have integer values (1 or 2).
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">g_train</span> <span class="o">=</span><span class="n">to</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">xs</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">to</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">xs</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span>
<span class="n">g_train</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{int8: ['Sex', 'Embarked', 'Boarded', 'Lifeboat', 'Body', 'Age_na', 'WikiId_na', 'Age_wiki_na', 'Class_na'], int16: ['Name', 'Ticket', 'Cabin', 'Name_wiki', 'Hometown', 'Destination'], float64: ['PassengerId', 'Pclass', 'SibSp', 'Parch', 'Age', 'Fare', 'WikiId', 'Age_wiki', 'Class']}</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here you can see 'Age_na', 'WikiId_na', 'Age_wiki_na', 'Class_na' . Which were created becoz their columns had missing values</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Generally what happens is, we cannot use the output of tabularpandas straightaway. So we need to access it as follows.. just taking peek at train data(for validation data replace train with valid)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span><span class="o">.</span><span class="n">train</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>     PassengerId  Survived    Pclass  Name  Sex       Age     SibSp     Parch  \
430    -0.059897       1.0 -1.585850    93    2 -0.120416 -0.472176 -0.462981   
158    -1.123753       0.0  0.827621   768    2 -0.120416 -0.472176 -0.462981   
453     0.030061       1.0 -1.585850   291    2  1.492635  0.468220 -0.462981   
750     1.191698       1.0 -0.379115   853    1 -1.963903  0.468220  0.811558   
250    -0.763919       0.0  0.827621   674    2 -0.120416 -0.472176 -0.462981   
..           ...       ...       ...   ...  ...       ...       ...       ...   
867     1.649312       0.0 -1.585850   697    2  0.110020 -0.472176 -0.462981   
193    -0.986860       1.0 -0.379115   580    2 -2.040715  0.468220  0.811558   
14     -1.686971       0.0  0.827621   841    1 -1.195784 -0.472176 -0.462981   
150    -1.155043       0.0 -0.379115    69    2  1.646259 -0.472176 -0.462981   
580     0.526788       1.0 -0.379115   161    1 -0.350852  0.468220  0.811558   

     Ticket      Fare  ...  Hometown  Boarded  Destination  Lifeboat  Body  \
430       4 -0.076707  ...       354        4          223        22     0   
158     259 -0.525029  ...       300        4          148         0     0   
453      85  1.491114  ...       291        2          149        13     0   
750     235 -0.165683  ...       172        4            4         6     0   
250     423 -0.560431  ...       293        4          148         0     0   
..      ...       ...  ...       ...      ...          ...       ...   ...   
867     591  0.523456  ...       385        4          216         0     0   
193     114 -0.090492  ...       280        4          148        22     0   
14      414 -0.545288  ...       324        4          123         0     0   
150     623 -0.428222  ...       194        4          107         0    23   
580     134  0.009761  ...       243        4          139         4     0   

        Class  Age_na  WikiId_na  Age_wiki_na  Class_na  
430 -1.585853       1          1            1         1  
158  0.827622       2          1            1         1  
453 -1.585853       1          1            1         1  
750 -0.379115       1          1            1         1  
250  0.827622       2          1            1         1  
..        ...     ...        ...          ...       ...  
867 -1.585853       1          1            1         1  
193 -0.379115       1          1            1         1  
14   0.827622       1          1            1         1  
150 -0.379115       1          1            1         1  
580 -0.379115       1          1            1         1  

[713 rows x 25 columns]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>using 'xs' to get the table in the manner we are used to see it. Notice that it is without 'Survived' column</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">xs</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Sex</th>
      <th>Ticket</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Name_wiki</th>
      <th>Hometown</th>
      <th>Boarded</th>
      <th>Destination</th>
      <th>Lifeboat</th>
      <th>...</th>
      <th>Class_na</th>
      <th>PassengerId</th>
      <th>Pclass</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Age</th>
      <th>Fare</th>
      <th>WikiId</th>
      <th>Age_wiki</th>
      <th>Class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>430</th>
      <td>93</td>
      <td>2</td>
      <td>4</td>
      <td>72</td>
      <td>3</td>
      <td>89</td>
      <td>354</td>
      <td>4</td>
      <td>223</td>
      <td>22</td>
      <td>...</td>
      <td>1</td>
      <td>-0.059897</td>
      <td>-1.585850</td>
      <td>-0.472176</td>
      <td>-0.462981</td>
      <td>-0.120416</td>
      <td>-0.076707</td>
      <td>-1.694354</td>
      <td>-0.099986</td>
      <td>-1.585853</td>
    </tr>
    <tr>
      <th>158</th>
      <td>768</td>
      <td>2</td>
      <td>259</td>
      <td>0</td>
      <td>3</td>
      <td>732</td>
      <td>300</td>
      <td>4</td>
      <td>148</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>-1.123753</td>
      <td>0.827621</td>
      <td>-0.472176</td>
      <td>-0.462981</td>
      <td>-0.120416</td>
      <td>-0.525029</td>
      <td>1.479525</td>
      <td>0.551559</td>
      <td>0.827622</td>
    </tr>
    <tr>
      <th>453</th>
      <td>291</td>
      <td>2</td>
      <td>85</td>
      <td>87</td>
      <td>1</td>
      <td>272</td>
      <td>291</td>
      <td>2</td>
      <td>149</td>
      <td>13</td>
      <td>...</td>
      <td>1</td>
      <td>0.030061</td>
      <td>-1.585850</td>
      <td>0.468220</td>
      <td>-0.462981</td>
      <td>1.492635</td>
      <td>1.491114</td>
      <td>-1.430308</td>
      <td>1.275499</td>
      <td>-1.585853</td>
    </tr>
    <tr>
      <th>750</th>
      <td>853</td>
      <td>1</td>
      <td>235</td>
      <td>0</td>
      <td>3</td>
      <td>818</td>
      <td>172</td>
      <td>4</td>
      <td>4</td>
      <td>6</td>
      <td>...</td>
      <td>1</td>
      <td>1.191698</td>
      <td>-0.379115</td>
      <td>0.468220</td>
      <td>0.811558</td>
      <td>-1.963903</td>
      <td>-0.165683</td>
      <td>-0.195430</td>
      <td>-1.837440</td>
      <td>-0.379115</td>
    </tr>
    <tr>
      <th>250</th>
      <td>674</td>
      <td>2</td>
      <td>423</td>
      <td>0</td>
      <td>3</td>
      <td>642</td>
      <td>293</td>
      <td>4</td>
      <td>148</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>-0.763919</td>
      <td>0.827621</td>
      <td>-0.472176</td>
      <td>-0.462981</td>
      <td>-0.120416</td>
      <td>-0.560431</td>
      <td>1.268822</td>
      <td>-0.751531</td>
      <td>0.827622</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>867</th>
      <td>697</td>
      <td>2</td>
      <td>591</td>
      <td>7</td>
      <td>3</td>
      <td>663</td>
      <td>385</td>
      <td>4</td>
      <td>216</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1.649312</td>
      <td>-1.585850</td>
      <td>-0.472176</td>
      <td>-0.462981</td>
      <td>0.110020</td>
      <td>0.523456</td>
      <td>-1.147593</td>
      <td>0.117196</td>
      <td>-1.585853</td>
    </tr>
    <tr>
      <th>193</th>
      <td>580</td>
      <td>2</td>
      <td>114</td>
      <td>142</td>
      <td>3</td>
      <td>555</td>
      <td>280</td>
      <td>4</td>
      <td>148</td>
      <td>22</td>
      <td>...</td>
      <td>1</td>
      <td>-0.986860</td>
      <td>-0.379115</td>
      <td>0.468220</td>
      <td>0.811558</td>
      <td>-2.040715</td>
      <td>-0.090492</td>
      <td>-0.387463</td>
      <td>-1.909834</td>
      <td>-0.379115</td>
    </tr>
    <tr>
      <th>14</th>
      <td>841</td>
      <td>1</td>
      <td>414</td>
      <td>0</td>
      <td>3</td>
      <td>806</td>
      <td>324</td>
      <td>4</td>
      <td>123</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>-1.686971</td>
      <td>0.827621</td>
      <td>-0.472176</td>
      <td>-0.462981</td>
      <td>-1.195784</td>
      <td>-0.545288</td>
      <td>1.650221</td>
      <td>-1.113501</td>
      <td>0.827622</td>
    </tr>
    <tr>
      <th>150</th>
      <td>69</td>
      <td>2</td>
      <td>623</td>
      <td>0</td>
      <td>3</td>
      <td>69</td>
      <td>194</td>
      <td>4</td>
      <td>107</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>-1.155043</td>
      <td>-0.379115</td>
      <td>-0.472176</td>
      <td>-0.462981</td>
      <td>1.646259</td>
      <td>-0.428222</td>
      <td>-0.878214</td>
      <td>1.565074</td>
      <td>-0.379115</td>
    </tr>
    <tr>
      <th>580</th>
      <td>161</td>
      <td>1</td>
      <td>134</td>
      <td>0</td>
      <td>3</td>
      <td>151</td>
      <td>243</td>
      <td>4</td>
      <td>139</td>
      <td>4</td>
      <td>...</td>
      <td>1</td>
      <td>0.526788</td>
      <td>-0.379115</td>
      <td>0.468220</td>
      <td>0.811558</td>
      <td>-0.350852</td>
      <td>0.009761</td>
      <td>-0.776863</td>
      <td>-0.317168</td>
      <td>-0.379115</td>
    </tr>
  </tbody>
</table>
<p>713 rows × 24 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>using the same for target value</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">ys</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([1., 0., 1., 1., 0., 0., 0., 1., 0., 0., 1., 0., 1., 1., 0., 0., 0.,
       1., 1., 0., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 1., 1., 1., 0.,
       1., 0., 0., 0., 1., 0., 0., 0., 0., 1., 1., 0., 0., 1., 1., 0., 0.,
       0., 0., 1., 1., 0., 1., 0., 1., 0., 0., 0., 1., 1., 0., 1., 0., 0.,
       0., 1., 1., 1., 0., 1., 0., 0., 0., 0., 1., 0., 1., 0., 0., 0., 0.,
       0., 0., 0., 1., 0., 0., 0., 0., 1., 0., 0., 1., 1., 1., 0., 1., 1.,
       1., 1., 1., 0., 0., 1., 0., 0., 1., 0., 0., 0., 0., 1., 0., 0., 1.,
       0., 0., 0., 0., 1., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0.,
       0., 0., 1., 1., 1., 0., 0., 0., 1., 0., 0., 0., 1., 0., 0., 0., 0.,
       0., 0., 1., 1., 0., 1., 0., 0., 0., 1., 1., 0., 0., 1., 0., 0., 0.,
       1., 1., 0., 0., 1., 0., 1., 1., 1., 0., 0., 0., 1., 1., 0., 0., 1.,
       0., 1., 0., 1., 0., 1., 0., 1., 0., 0., 0., 0., 1., 1., 0., 1., 0.,
       0., 0., 1., 0., 1., 1., 0., 1., 0., 1., 0., 0., 0., 0., 0., 1., 1.,
       0., 0., 0., 0., 1., 0., 0., 0., 0., 1., 1., 1., 0., 0., 1., 0., 0.,
       1., 1., 1., 0., 1., 0., 0., 1., 0., 0., 0., 0., 1., 1., 1., 0., 1.,
       1., 0., 0., 0., 1., 0., 1., 0., 0., 1., 0., 1., 1., 1., 0., 0., 0.,
       0., 1., 1., 1., 1., 0., 0., 0., 0., 1., 1., 0., 0., 0., 1., 0., 0.,
       0., 0., 1., 0., 0., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0.,
       0., 1., 0., 0., 0., 0., 0., 1., 1., 0., 0., 0., 0., 0., 0., 0., 1.,
       0., 0., 0., 1., 0., 0., 0., 1., 1., 1., 0., 0., 1., 0., 0., 0., 1.,
       0., 0., 1., 0., 0., 1., 1., 1., 0., 0., 0., 0., 0., 1., 1., 1., 0.,
       1., 0., 0., 0., 1., 0., 1., 1., 0., 0., 0., 1., 0., 0., 1., 0., 1.,
       1., 1., 1., 0., 1., 0., 1., 0., 1., 0., 0., 0., 0., 0., 0., 1., 1.,
       0., 0., 0., 0., 0., 1., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 1.,
       0., 1., 0., 0., 0., 0., 0., 0., 1., 1., 0., 0., 1., 0., 1., 0., 0.,
       0., 0., 0., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 0., 1., 0., 0.,
       0., 1., 0., 0., 0., 0., 1., 1., 1., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 1., 0., 0., 1., 1., 0., 0., 0., 0., 0., 0., 1., 1., 1., 0., 1.,
       0., 0., 0., 0., 0., 0., 0., 1., 1., 0., 0., 1., 0., 0., 0., 1., 0.,
       0., 1., 0., 1., 1., 0., 0., 0., 0., 0., 1., 1., 0., 0., 0., 0., 0.,
       1., 1., 0., 1., 1., 1., 0., 1., 0., 0., 1., 0., 1., 1., 0., 0., 1.,
       0., 1., 0., 0., 0., 0., 0., 0., 1., 1., 1., 0., 1., 1., 0., 0., 0.,
       0., 0., 0., 0., 0., 1., 0., 1., 1., 1., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 1., 0., 0., 1., 0., 0., 1., 0., 0., 1., 0., 1., 1.,
       0., 0., 0., 1., 1., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 1., 0.,
       1., 0., 0., 0., 0., 0., 1., 0., 1., 0., 1., 1., 1., 1., 0., 0., 0.,
       1., 1., 1., 1., 0., 1., 0., 0., 1., 0., 1., 1., 0., 0., 0., 0., 0.,
       1., 0., 1., 1., 0., 1., 1., 1., 0., 1., 0., 0., 1., 1., 0., 0., 0.,
       0., 0., 1., 0., 1., 0., 0., 1., 0., 1., 0., 0., 1., 1., 0., 0., 0.,
       1., 1., 1., 0., 0., 1., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0.,
       0., 1., 0., 0., 0., 1., 0., 0., 1., 1., 1., 1., 0., 0., 0., 0., 1.,
       1., 0., 1., 0., 0., 1., 0., 1., 1., 1., 0., 0., 1., 0., 0., 1.],
      dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Model:">
<a class="anchor" href="#Model:" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model:<a class="anchor-link" href="#Model:"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we got our data preprocessed. It's time to model the data. For this problem i am using RandomForestClassifier it's powerful and simple. And taking out X_train and y_train values like we showed before examples.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="n">to</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">ys</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">valid</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="n">to</span><span class="o">.</span><span class="n">valid</span><span class="o">.</span><span class="n">ys</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have table without any hardcore preprocessing all we did was just to use fastai tabular function to get this</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Sex</th>
      <th>Ticket</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Name_wiki</th>
      <th>Hometown</th>
      <th>Boarded</th>
      <th>Destination</th>
      <th>Lifeboat</th>
      <th>...</th>
      <th>Class_na</th>
      <th>PassengerId</th>
      <th>Pclass</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Age</th>
      <th>Fare</th>
      <th>WikiId</th>
      <th>Age_wiki</th>
      <th>Class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>430</th>
      <td>93</td>
      <td>2</td>
      <td>4</td>
      <td>72</td>
      <td>3</td>
      <td>89</td>
      <td>354</td>
      <td>4</td>
      <td>223</td>
      <td>22</td>
      <td>...</td>
      <td>1</td>
      <td>-0.059897</td>
      <td>-1.585850</td>
      <td>-0.472176</td>
      <td>-0.462981</td>
      <td>-0.120416</td>
      <td>-0.076707</td>
      <td>-1.694354</td>
      <td>-0.099986</td>
      <td>-1.585853</td>
    </tr>
    <tr>
      <th>158</th>
      <td>768</td>
      <td>2</td>
      <td>259</td>
      <td>0</td>
      <td>3</td>
      <td>732</td>
      <td>300</td>
      <td>4</td>
      <td>148</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>-1.123753</td>
      <td>0.827621</td>
      <td>-0.472176</td>
      <td>-0.462981</td>
      <td>-0.120416</td>
      <td>-0.525029</td>
      <td>1.479525</td>
      <td>0.551559</td>
      <td>0.827622</td>
    </tr>
    <tr>
      <th>453</th>
      <td>291</td>
      <td>2</td>
      <td>85</td>
      <td>87</td>
      <td>1</td>
      <td>272</td>
      <td>291</td>
      <td>2</td>
      <td>149</td>
      <td>13</td>
      <td>...</td>
      <td>1</td>
      <td>0.030061</td>
      <td>-1.585850</td>
      <td>0.468220</td>
      <td>-0.462981</td>
      <td>1.492635</td>
      <td>1.491114</td>
      <td>-1.430308</td>
      <td>1.275499</td>
      <td>-1.585853</td>
    </tr>
    <tr>
      <th>750</th>
      <td>853</td>
      <td>1</td>
      <td>235</td>
      <td>0</td>
      <td>3</td>
      <td>818</td>
      <td>172</td>
      <td>4</td>
      <td>4</td>
      <td>6</td>
      <td>...</td>
      <td>1</td>
      <td>1.191698</td>
      <td>-0.379115</td>
      <td>0.468220</td>
      <td>0.811558</td>
      <td>-1.963903</td>
      <td>-0.165683</td>
      <td>-0.195430</td>
      <td>-1.837440</td>
      <td>-0.379115</td>
    </tr>
    <tr>
      <th>250</th>
      <td>674</td>
      <td>2</td>
      <td>423</td>
      <td>0</td>
      <td>3</td>
      <td>642</td>
      <td>293</td>
      <td>4</td>
      <td>148</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>-0.763919</td>
      <td>0.827621</td>
      <td>-0.472176</td>
      <td>-0.462981</td>
      <td>-0.120416</td>
      <td>-0.560431</td>
      <td>1.268822</td>
      <td>-0.751531</td>
      <td>0.827622</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Model initialization using sklearn. We are simply using 100 different decision trees. Keeping the model parameters simple as possible so that we don't overfit either.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rnf_classifier</span><span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">rnf_classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RandomForestClassifier(n_jobs=-1)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We just Trained randomforest classifier and predicting accuracy on validation set</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Accuracy-on-validation-dataset">
<a class="anchor" href="#Accuracy-on-validation-dataset" aria-hidden="true"><span class="octicon octicon-link"></span></a>Accuracy on validation dataset<a class="anchor-link" href="#Accuracy-on-validation-dataset"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred</span><span class="o">=</span><span class="n">rnf_classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)</span>


<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9943820224719101</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>WOW, we get the accuracy of 0.99 on validation dataset this means on leader board getting rank of 200 something our of 19,000.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="TEST-dataset">
<a class="anchor" href="#TEST-dataset" aria-hidden="true"><span class="octicon octicon-link"></span></a>TEST dataset<a class="anchor-link" href="#TEST-dataset"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We need to turn the test data format as intended so that to out feed in model. Taking look at test data</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>WikiId</th>
      <th>Name_wiki</th>
      <th>Age_wiki</th>
      <th>Hometown</th>
      <th>Boarded</th>
      <th>Destination</th>
      <th>Lifeboat</th>
      <th>Body</th>
      <th>Class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>892</td>
      <td>3</td>
      <td>Kelly, Mr. James</td>
      <td>male</td>
      <td>34.5</td>
      <td>0</td>
      <td>0</td>
      <td>330911</td>
      <td>7.8292</td>
      <td>NaN</td>
      <td>Q</td>
      <td>928.0</td>
      <td>Kelly, Mr. James</td>
      <td>19.0</td>
      <td>Unknown, Ireland</td>
      <td>Southampton</td>
      <td>New York City</td>
      <td>NaN</td>
      <td>70MB</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>893</td>
      <td>3</td>
      <td>Wilkes, Mrs. James (Ellen Needs)</td>
      <td>female</td>
      <td>47.0</td>
      <td>1</td>
      <td>0</td>
      <td>363272</td>
      <td>7.0000</td>
      <td>NaN</td>
      <td>S</td>
      <td>1297.0</td>
      <td>Wilkes, Mrs. Ellen</td>
      <td>47.0</td>
      <td>Penzance, Cornwall, England</td>
      <td>Southampton</td>
      <td>Akron, Ohio, US</td>
      <td>16</td>
      <td>NaN</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>894</td>
      <td>2</td>
      <td>Myles, Mr. Thomas Francis</td>
      <td>male</td>
      <td>62.0</td>
      <td>0</td>
      <td>0</td>
      <td>240276</td>
      <td>9.6875</td>
      <td>NaN</td>
      <td>Q</td>
      <td>518.0</td>
      <td>Myles, Mr. Thomas Francis</td>
      <td>63.0</td>
      <td>Fermoy, Ireland[note 1]</td>
      <td>Queenstown</td>
      <td>Waban, Massachusetts, US</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>895</td>
      <td>3</td>
      <td>Wirz, Mr. Albert</td>
      <td>male</td>
      <td>27.0</td>
      <td>0</td>
      <td>0</td>
      <td>315154</td>
      <td>8.6625</td>
      <td>NaN</td>
      <td>S</td>
      <td>1303.0</td>
      <td>Wirz, Mr. Albert</td>
      <td>27.0</td>
      <td>Uster, Switzerland</td>
      <td>Southampton</td>
      <td>Beloit, Wisconsin, US</td>
      <td>NaN</td>
      <td>131MB</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>896</td>
      <td>3</td>
      <td>Hirvonen, Mrs. Alexander (Helga E Lindqvist)</td>
      <td>female</td>
      <td>22.0</td>
      <td>1</td>
      <td>1</td>
      <td>3101298</td>
      <td>12.2875</td>
      <td>NaN</td>
      <td>S</td>
      <td>871.0</td>
      <td>Hirvonen, Mrs. Helga Elisabeth (née Lindqvist)</td>
      <td>22.0</td>
      <td>Taalintehdas, Finland</td>
      <td>Southampton</td>
      <td>Monessen, Pennsylvania, US</td>
      <td>15</td>
      <td>NaN</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>doing the same preprocessing we did for training set</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_test</span><span class="o">.</span><span class="n">dtypes</span>
<span class="n">g_train</span> <span class="o">=</span><span class="n">df_test</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df_test</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span>
<span class="n">g_train</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{int64: ['PassengerId', 'Pclass', 'SibSp', 'Parch'], float64: ['Age', 'Fare', 'WikiId', 'Age_wiki', 'Class'], object: ['Name', 'Sex', 'Ticket', 'Cabin', 'Embarked', 'Name_wiki', 'Hometown', 'Boarded', 'Destination', 'Lifeboat', 'Body']}</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat_names</span><span class="o">=</span> <span class="p">[</span>
        <span class="s1">'Name'</span><span class="p">,</span> <span class="s1">'Sex'</span><span class="p">,</span> <span class="s1">'Ticket'</span><span class="p">,</span> <span class="s1">'Cabin'</span><span class="p">,</span> 
        <span class="s1">'Embarked'</span><span class="p">,</span> <span class="s1">'Name_wiki'</span><span class="p">,</span> <span class="s1">'Hometown'</span><span class="p">,</span> 
        <span class="s1">'Boarded'</span><span class="p">,</span> <span class="s1">'Destination'</span><span class="p">,</span> <span class="s1">'Lifeboat'</span><span class="p">,</span> 
        <span class="s1">'Body'</span>
<span class="p">]</span>

<span class="n">cont_names</span> <span class="o">=</span> <span class="p">[</span> 
    <span class="s1">'PassengerId'</span><span class="p">,</span> <span class="s1">'Pclass'</span><span class="p">,</span> <span class="s1">'SibSp'</span><span class="p">,</span> <span class="s1">'Parch'</span><span class="p">,</span> 
    <span class="s1">'Age'</span><span class="p">,</span> <span class="s1">'Fare'</span><span class="p">,</span> <span class="s1">'WikiId'</span><span class="p">,</span> <span class="s1">'Age_wiki'</span><span class="p">,</span><span class="s1">'Class'</span>
 <span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now further, Avoiding y_name and split for obvious reasons.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span> <span class="o">=</span> <span class="n">TabularPandas</span><span class="p">(</span><span class="n">df_test</span><span class="p">,</span> <span class="n">procs</span><span class="o">=</span><span class="p">[</span><span class="n">Categorify</span><span class="p">,</span> <span class="n">FillMissing</span><span class="p">,</span><span class="n">Normalize</span><span class="p">],</span>
                   <span class="n">cat_names</span> <span class="o">=</span> <span class="n">cat_names</span><span class="p">,</span>
                   <span class="n">cont_names</span> <span class="o">=</span> <span class="n">cont_names</span><span class="p">,</span>
                   <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>getting the table value for test dataset. we used train.xs becoz it lets us extact the data we had given the tabularpandas function</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Sex</th>
      <th>Ticket</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Name_wiki</th>
      <th>Hometown</th>
      <th>Boarded</th>
      <th>Destination</th>
      <th>Lifeboat</th>
      <th>...</th>
      <th>Class_na</th>
      <th>PassengerId</th>
      <th>Pclass</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Age</th>
      <th>Fare</th>
      <th>WikiId</th>
      <th>Age_wiki</th>
      <th>Class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>207</td>
      <td>2</td>
      <td>153</td>
      <td>0</td>
      <td>2</td>
      <td>194</td>
      <td>226</td>
      <td>4</td>
      <td>103</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>-1.727912</td>
      <td>0.873482</td>
      <td>-0.499470</td>
      <td>-0.400248</td>
      <td>0.386231</td>
      <td>-0.497413</td>
      <td>0.752828</td>
      <td>-0.794545</td>
      <td>0.871140</td>
    </tr>
    <tr>
      <th>1</th>
      <td>404</td>
      <td>1</td>
      <td>222</td>
      <td>0</td>
      <td>3</td>
      <td>389</td>
      <td>162</td>
      <td>4</td>
      <td>2</td>
      <td>9</td>
      <td>...</td>
      <td>1</td>
      <td>-1.719625</td>
      <td>0.873482</td>
      <td>0.616992</td>
      <td>-0.400248</td>
      <td>1.371369</td>
      <td>-0.512278</td>
      <td>1.729823</td>
      <td>1.304755</td>
      <td>0.871140</td>
    </tr>
    <tr>
      <th>2</th>
      <td>270</td>
      <td>2</td>
      <td>74</td>
      <td>0</td>
      <td>2</td>
      <td>257</td>
      <td>65</td>
      <td>3</td>
      <td>154</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>-1.711337</td>
      <td>-0.315819</td>
      <td>-0.499470</td>
      <td>-0.400248</td>
      <td>2.553536</td>
      <td>-0.464100</td>
      <td>-0.332721</td>
      <td>2.504355</td>
      <td>-0.311121</td>
    </tr>
    <tr>
      <th>3</th>
      <td>409</td>
      <td>2</td>
      <td>148</td>
      <td>0</td>
      <td>3</td>
      <td>393</td>
      <td>233</td>
      <td>4</td>
      <td>13</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>-1.703050</td>
      <td>0.873482</td>
      <td>-0.499470</td>
      <td>-0.400248</td>
      <td>-0.204852</td>
      <td>-0.482475</td>
      <td>1.745709</td>
      <td>-0.194745</td>
      <td>0.871140</td>
    </tr>
    <tr>
      <th>4</th>
      <td>179</td>
      <td>1</td>
      <td>139</td>
      <td>0</td>
      <td>3</td>
      <td>167</td>
      <td>208</td>
      <td>4</td>
      <td>94</td>
      <td>7</td>
      <td>...</td>
      <td>1</td>
      <td>-1.694763</td>
      <td>0.873482</td>
      <td>0.616992</td>
      <td>0.619896</td>
      <td>-0.598908</td>
      <td>-0.417491</td>
      <td>0.601910</td>
      <td>-0.569620</td>
      <td>0.871140</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 25 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now taking a look at features present in test data.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description" open="">
      <summary class="btn btn-sm" data-open="Hide Code" data-close="Show Code"></summary>
        <p></p>
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_test</span><span class="o">.</span><span class="n">dtypes</span>
<span class="n">g_train</span> <span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span>
<span class="n">g_train</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{int8: ['Sex', 'Cabin', 'Embarked', 'Boarded', 'Lifeboat', 'Body', 'Age_na', 'Fare_na', 'WikiId_na', 'Age_wiki_na', 'Class_na'], int16: ['Name', 'Ticket', 'Name_wiki', 'Hometown', 'Destination'], float64: ['PassengerId', 'Pclass', 'SibSp', 'Parch', 'Age', 'Fare', 'WikiId', 'Age_wiki', 'Class']}</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p>
<div class="flash flash-error">
    <svg class="octicon octicon-alert octicon octicon-alert octicon octicon-alert" viewbox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z"></path></svg>
    <strong>Warning: </strong>See that we are dropping <code>Fare_na</code> column
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_test</span><span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'Fare_na'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now you would be thinking why we are dropping the 'Fare_na' column. The reason is, originally we trained model on 24 features. But as you know that tabularpandas function creates a new column if there is any missing value spotted in any particular feature.</p>
<p>Here, our test data had some Fare values missing so the function created the boolean column this lead to 25 features. If you try to pass without dropping Fare_na column, it will give you the error that model was trained on 24 features and we are passing 25. That's why dropping Fare_na feature. And dont worry it doesnt have any effect on the output</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is our output</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">output</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'PassengerId'</span><span class="p">:</span><span class="n">df_test</span><span class="o">.</span><span class="n">PassengerId</span><span class="p">,</span> <span class="s1">'Survived'</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">})</span>
<span class="n">output</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">'my_submission_titanic.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">output</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>892</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>893</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>894</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>895</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>896</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="hiteshhedwig/hedwig-explains"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/hedwig-explains/fastai/kaggle/datascience/2020/10/13/titanic-fastai.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/hedwig-explains/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/hedwig-explains/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/hedwig-explains/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>A Personal Blogging platform</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/hiteshhedwig" title="hiteshhedwig"><svg class="svg-icon grey"><use xlink:href="/hedwig-explains/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/rnnishard" title="rnnishard"><svg class="svg-icon grey"><use xlink:href="/hedwig-explains/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
